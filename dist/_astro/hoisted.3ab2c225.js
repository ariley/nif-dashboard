import"https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js";document.getElementById("uploadForm").addEventListener("submit",async c=>{c.preventDefault();const t=document.getElementById("error"),s=document.getElementById("success");t.textContent="",s.textContent="";const o=document.getElementById("file").files[0];if(!o){console.log("No file selected"),t.textContent="No file selected.";return}console.log("File selected:",o.name);const n=new FormData;n.append("file",o);try{console.log("Uploading file...");const e=await fetch("http://localhost:3000/upload",{method:"POST",body:n});if(console.log("Response status:",e.status),console.log("Response headers:",[...e.headers]),!e.ok){const r=await e.text();throw console.log("Error response text:",r),new Error(r)}const l=await e.json();console.log("Upload result:",l),s.textContent=l.message||"File uploaded successfully.",setTimeout(()=>{window.location.href="/"},2e3)}catch(e){console.log("Upload error:",e),t.textContent="An error occurred: "+e.message}});
